/*******************************************************************************
 * Includes
 ******************************************************************************/

#include "distrib.h"
#include "rng.h"
#include <math.h>

/*******************************************************************************
 * Macros
 ******************************************************************************/

#ifndef M_PI
#define M_PI 3.14159265358979323846
#endif

/*******************************************************************************
 * Types
 ******************************************************************************/

/*******************************************************************************
 * Internal function declaration
 ******************************************************************************/

/*******************************************************************************
 * Variables
 ******************************************************************************/

/*******************************************************************************
 * Public function
 ******************************************************************************/

/*
 * ~ U(0, 1) continue
 */
double Unif01d(void) { return RNG_RandDouble(); }

/*
 * ~ U(a, b) continue
 */
double Unifd(double a, double b) { return Unif01d() * (b - a) + a; }

/*
 * ~ U(a, b) discrete
 */
uint32_t Unifi(uint32_t a, uint32_t b) { return RNG_RandInt() % (b - a) + a; }

/*
 * ~ B(p)
 */
uint32_t Bern(double p) { return RNG_RandDouble() < p; }

/*
 * ~ N(0, 1)
 * Boxâ€“Muller transform
 * TODO : optimisation cos sin
 */
double Normal01(void) {
  return sqrt(-2 * log(RNG_RandDouble())) * cos(2 * M_PI * RNG_RandDouble());
}

/*
 * ~ N(mean, eq/!\)
 */
double Normal(double m, double eq) { return Normal01() * eq + m; }

/*
 * ~ Exp(lambda)
 */
double Exp(double lambda) { return -log(RNG_RandDouble()) / lambda; }

/*******************************************************************************
 * Internal function
 ******************************************************************************/
